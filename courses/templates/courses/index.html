## mako
<%!
import random
from django.utils.translation import ugettext as _
from django.core.urlresolvers import reverse
from courseware.courses import course_image_url, get_course_about_section

from courses.models import CourseSubject
from universities.models import University

course_subjects_by_score = CourseSubject.objects.by_score()
course_subjects_by_name = CourseSubject.objects.by_name()
universities_by_score = University.objects.by_score()
universities_by_name = University.objects.by_name()
%>

<%inherit file="/funsite/parts/base.html" />

<%block name="title">${_("Courses")}</%block>


<%block name="js_extra">
<script>
    $('#show-all-themes').on('click', function(event) {
        console.log(event);
        $('#all-themes-overlay').show();

        var posy =  $(this).prev().prev().offset().top - $('.filters').offset().top;
        $('#all-themes-overlay').css('top', posy + 'px');



    });


</script>
</%block>

<%block name="content">

<img class="img-responsive" src="https://placeholdit.imgix.net/~text?txtsize=50&txt=width1920&w=1920&h=400">


<div class="row">
    <div class="col-lg-36 big-title text-center">
        <h2>Les cours à la une</h2>
    </div>
</div>


<div class="highlighted-courses">

    <div class="row">
        <!-- haute def > 1350: 4 mises en avant principales -->
        <ul class="primary-highlight">
            <li>
                <%include file="/funsite/parts/big-course-block.html" args="id=1"/>
            </li>
            <li>
                <%include file="/funsite/parts/big-course-block.html" args="id=2" />
            </li>
            <li class="hidden-960">
                <%include file="/funsite/parts/big-course-block.html" args="id=3" />
            </li>
            <li class="hidden-1280">
                <%include file="/funsite/parts/big-course-block.html" args="id=3" />
            </li>
        </ul>
    </div>
</div>



    %for course in courses:
          <a href="${reverse('about_course', args=[course.id.to_deprecated_string()])}">
            ${get_course_about_section(course, 'title')}<br>
        </a>
    %endfor


<div class="course-list">

    <div class="row">

        <div class="col-md-12">
            <!-- <div class="filters" data-spy="affix" data-offset-top="820" data-offset-bottom="90"> -->
            <div class="filters criteria-block">
                <h1>Recherche</h1>
                <h2>Disponibilité</h2>
                <ul class="criteria">
                    <li>Nouveau cours<span class="badge pull-right">22</span></li>
                    <li>Fin d'inscription imminente<span class="badge pull-right">5</span></li>
                    <li>Démarre bientôt<span class="badge pull-right">99</span></li>
                    <li>A la demande<span class="badge pull-right">27</span></li>
                </ul>
                <h2>Thèmes</h2>
                <ul class="criteria">
                    %for course_subject in course_subjects_by_score[:8]:
                    <li>
                        ${ course_subject.short_name or course_subject.name }
                        <span class="badge pull-right">${ course_subject.courses.count() }</span>
                    </li>
                    %endfor
                </ul>
                <span class="all-items-button" id="show-all-themes"><a href="">Toutes les thèmes</a></span>
                <h2>Établissements</h2>
                <ul class="criteria">
                    %for university in universities_by_score[:10]:
                    <li>
                        ${ university.short_name or university.name }
                        <span class="badge pull-right">${ university.courses.count() }</span>
                    </li>
                    %endfor
                </ul>
                <br />Touts les établissements:
                    %for university in universities_by_name:
                    <li>
                        ${ university.short_name or university.name }
                        <span class="badge pull-right">${ university.courses.count() }</span>
                    </li>
                    %endfor
                </ul>

            </div>
        </div>

        <div class="col-md-24">
            <div class="pagination">

            </div>
            <div class="list">
                <ul>
                    %for a in range(30):  ## mutliple of 5, 3, 2 and 1
                    <li>
                        <%include file="/funsite/parts/small-course-block.html" args="id=1" />
                    </li>
                    %endfor
                </ul>

            </div>

            <div id="all-themes-overlay" class="criteria-overlay criteria-block hide-on-escake-key">
                <h2>Tous les tèmes</h2>
                <ul class="criteria">
                    %for course_subject in course_subjects_by_name:
                    <li>
                        ${ course_subject.short_name or course_subject.name }
                        <span class="badge pull-right">${ course_subject.courses.count() }</span>
                    </li>
                    %endfor
                </ul>

            </div>


        </div>



    </div>

</div>
</%block>
